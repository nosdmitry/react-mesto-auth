(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{24:function(e,t,a){},40:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(26),c=a.n(s),o=(a(24),a(4)),i=a(7),l=a(2),u=a.p+"static/media/avatar-loader.7741db8b.gif",d=a.p+"static/media/reg_failed.df8eddf6.svg",m=a.p+"static/media/reg_confirm.1b6082f8.svg",j=a.p+"static/media/logo.03b78ada.svg",b=a(11),p=a(0);var _=function(e){var t=e.userData,a=e.signOut,n=e.isMenuOpen;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("li",{className:"navbar__item",children:Object(p.jsx)(b.b,{to:"#",className:"navbar__link ".concat(n?"navbar__link_place_wrap":""),children:t.email})}),Object(p.jsx)("li",{className:"navbar__item",children:Object(p.jsx)(b.b,{to:"/",onClick:a,className:"navbar__link ".concat(n?"navbar__link_place_wrap":""),children:"\u0412\u044b\u0439\u0442\u0438"})})]})};a.p;var h=function(e){var t=e.isLoggedIn,a=e.signOut,n=e.userData,r=e.location,s=e.handleMenuOpen,c=e.isMenuOpen;return Object(p.jsx)("ul",{className:"navbar",children:t?t&&window.innerWidth<768?Object(p.jsx)(p.Fragment,{children:Object(p.jsx)("button",{className:"\n              header__menu-button \n              ".concat(c?"header__menu-button_type_opened":"header__menu-button_type_closed","\n            "),"aria-label":"menu button",onClick:s})}):Object(p.jsx)(_,{userData:n,signOut:a,isMenuOpen:c}):"/signup"===r.pathname?Object(p.jsx)("li",{className:"navbar__item",children:Object(p.jsx)(b.b,{to:"/signin",className:"navbar__link",children:"\u0412\u0445\u043e\u0434"})}):Object(p.jsx)("li",{className:"navbar__item",children:Object(p.jsx)(b.b,{to:"/signup",className:"navbar__link",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})})})},f=a(3);var O=function(e){var t=Object(f.g)();return Object(p.jsxs)("header",{className:"header",children:[Object(p.jsx)("div",{className:"\n          user-data-wrap \n          ".concat(e.isMenuOpen?"":"user-data-wrap_visible_hidden","\n        "),children:Object(p.jsx)(_,Object(o.a)({},e))}),Object(p.jsx)("a",{href:"./",className:"header__logo-link",target:"_self",children:Object(p.jsx)("img",{src:j,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f",className:"header__logo"})}),Object(p.jsx)(h,Object(o.a)(Object(o.a)({},e),{},{location:t}))]})},g=r.a.createContext();var x=function(e){var t=e.card,a=e.openImage,n=e.onCardLike,s=e.onDeleteCardClick,c=r.a.useContext(g),o=c._id===t.owner._id,i=t.likes.some((function(e){return e._id===c._id}))?"galery__heart galery__heart_active":"galery__heart";return Object(p.jsxs)("article",{className:"galery__card",children:[Object(p.jsx)("button",{onClick:function(){s(t)},type:"button",className:"galery__delete-card-button galery__delete-card-button".concat(o?"":"_visible_hidden"),"aria-label":"Delete_card"}),Object(p.jsx)("img",{onClick:function(){a(t)},src:t.link,alt:t.name,className:"galery__img"}),Object(p.jsx)("h2",{className:"galery__text",children:t.name}),Object(p.jsxs)("div",{className:"galery__likes-wrap",children:[Object(p.jsx)("button",{onClick:function(){n(t)},type:"button","aria-label":"Like",className:i}),Object(p.jsx)("div",{className:"galery__heart galery__heart_loading galery__heart_visible_hidden"}),Object(p.jsx)("span",{className:"galery__likes-counter",children:t.likes.length})]})]})};var v=function(){return Object(p.jsx)("div",{className:"galery__card galery__card_loading"})};var N=function(e){var t=r.a.useContext(g);return Object(p.jsxs)("main",{children:[Object(p.jsxs)("section",{className:"profile",children:[Object(p.jsx)("button",{onClick:e.onEditAvatar,className:"profile__image profile__image",style:{backgroundImage:"url(".concat(t.avatar,")")},"aria-label":"\u0410\u0432\u0430\u0442\u0430\u0440"}),Object(p.jsxs)("div",{className:"profile__text-wrap",children:[Object(p.jsxs)("div",{className:"profile__title-wrap",children:[Object(p.jsx)("h1",{className:"profile__title","aria-label":"\u0418\u043c\u044f",children:t.name}),Object(p.jsx)("button",{onClick:e.onEditProfile,type:"button","aria-label":"Edit_profile",className:"profile__edit"})]}),Object(p.jsx)("p",{className:"profile__subtitle","aria-label":"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",children:t.about})]}),Object(p.jsx)("button",{onClick:e.onAddPlace,type:"button","aria-label":"Add_img",className:"profile__add-card-button"})]}),Object(p.jsx)("section",{className:"galery galery_margins","aria-label":"\u0413\u0430\u043b\u0435\u0440\u0435\u044f",children:Object(p.jsx)("div",{className:"galery__cards",children:e.loadingSpinner?Object(p.jsx)(v,{}):e.cards.map((function(t){return Object(p.jsx)(x,{card:t,openImage:e.onCardClick,onCardLike:e.onCardLike,onDeleteCardClick:e.onDeleteCardClick},t._id)}))})})]})};var C=function(){return Object(p.jsx)("footer",{className:"footer",children:Object(p.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Mesto Russia"})})},y=a(15);var k=function(e){return Object(p.jsx)("div",{className:"popup popup_type_".concat(e.name," ").concat(e.isOpen?"popup_opened":""),children:Object(p.jsxs)("div",{className:"popup__container",children:[Object(p.jsx)("button",{onClick:e.onClose,type:"button","aria-label":"Close_popup",className:"popup__exit-button exit exit_button_profile-popup"}),Object(p.jsx)("h3",{className:"popup__form-title",children:e.title}),Object(p.jsxs)("form",{onSubmit:e.onSubmit,name:"popup_form_".concat(e.name),className:"form popup__form",noValidate:!0,children:[e.children,Object(p.jsx)("button",{type:"submit",name:"submit-edit-profile",className:"form__submit form__submit_type_popup",children:e.submitName})]})]})})};var S=function(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateUser,s=e.submitButtonName,c=Object(y.a)(),i=c.register,u=c.formState.errors,d=c.handleSubmit,m=r.a.useContext(g),j=r.a.useState(m.name),b=Object(l.a)(j,2),_=b[0],h=b[1],f=r.a.useState(m.about),O=Object(l.a)(f,2),x=O[0],v=O[1];return r.a.useEffect((function(){h(m.name),v(m.about)}),[m]),Object(p.jsxs)(k,{name:"profile-edit-form",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",submitName:s,isOpen:t,onClose:a,onSubmit:d((function(){n({name:_,about:x})})),children:[Object(p.jsxs)("label",{className:"form__form-field",children:[Object(p.jsx)("input",Object(o.a)(Object(o.a)({type:"text"},i("name",{required:"\u041f\u043e\u043b\u0435 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c",minLength:{value:2,message:"\u0418\u043c\u044f \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043a\u043e\u0440\u043e\u0447\u0435 \u0434\u0432\u0443\u0445 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"},maxLength:{value:40,message:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u0434\u043b\u0438\u043d\u043d\u043e\u0435. \u0421\u0434\u0435\u043b\u0430\u0439\u0442\u0435 \u043a\u043e\u0440\u043e\u0447\u0435 40 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"}})),{},{value:_,placeholder:"\u0418\u043c\u044f",className:"form__input",onChange:function(e){h(e.target.value)}})),u.name&&Object(p.jsx)("span",{className:"form__error",children:u.name.message})]}),Object(p.jsxs)("label",{className:"form__form-field",children:[Object(p.jsx)("input",Object(o.a)(Object(o.a)({type:"text"},i("description",{required:"\u041f\u043e\u043b\u0435 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c",minLength:{value:2,message:"\u0418\u043c\u044f \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043a\u043e\u0440\u043e\u0447\u0435 \u0434\u0432\u0443\u0445 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"},maxLength:{value:200,message:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u0434\u043b\u0438\u043d\u043d\u043e\u0435. \u0421\u0434\u0435\u043b\u0430\u0439\u0442\u0435 \u043a\u043e\u0440\u043e\u0447\u0435 200 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"}})),{},{value:x,minLength:"2",maxLength:"200",placeholder:"\u0420\u043e\u0434 \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438",className:"form__input",onChange:function(e){v(e.target.value)}})),u.description&&Object(p.jsx)("span",{className:"form__error",children:u.description.message})]})]})};var E=function(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateAvatar,r=e.submitButtonName,s=Object(y.a)(),c=s.register,i=s.formState.errors,l=s.handleSubmit,u=(0,s.watch)("userAvatar");return Object(p.jsx)(k,{id:"userAvatar",name:"change-avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",submitName:r,isOpen:t,onClose:a,onSubmit:l((function(){return console.log(u),void n({avatar:u})})),children:Object(p.jsxs)("label",{htmlFor:"userAvatar",className:"form__form-field",children:[Object(p.jsx)("input",Object(o.a)(Object(o.a)({id:"userAvatar",type:"url"},c("userAvatar",{required:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 URL \u0430\u0434\u0440\u0435\u0441"})),{},{placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"form__input"})),i.userAvatar&&Object(p.jsx)("span",{className:"form__error",children:i.userAvatar.message})]})})};var L=function(e){var t=e.isOpen,a=e.onClose,n=e.onAddPlace,s=e.submitButtonName,c=r.a.useState(""),i=Object(l.a)(c,2),u=i[0],d=i[1],m=r.a.useState(""),j=Object(l.a)(m,2),b=j[0],_=j[1],h=Object(y.a)(),f=h.register,O=h.formState.errors,g=h.handleSubmit;return Object(p.jsxs)(k,{name:"cards-add-form",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",submitName:s,isOpen:t,onClose:a,onSubmit:g((function(){n({name:u,link:b})})),children:[Object(p.jsxs)("label",{className:"form__form-field",children:[Object(p.jsx)("input",Object(o.a)(Object(o.a)({id:"place-name",type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"form__input"},f("title",{required:"\u041f\u043e\u043b\u0435 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c",minLength:{value:2,message:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043a\u043e\u0440\u043e\u0447\u0435 \u0434\u0432\u0443\u0445 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"},maxLength:{value:30,message:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043a\u043e\u0440\u043e\u0447\u0435 30 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"},value:u})),{},{onChange:function(e){d(e.target.value)}})),O.title&&Object(p.jsx)("span",{className:"form__error",children:O.title.message})]}),Object(p.jsxs)("label",{className:"form__form-field",children:[Object(p.jsx)("input",Object(o.a)(Object(o.a)({id:"place-url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"form__input",type:"url"},f("cardUrl",{required:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 URL \u0430\u0434\u0440\u0435\u0441",value:b})),{},{onChange:function(e){_(e.target.value)},required:!0})),O.cardUrl&&Object(p.jsx)("span",{className:"form__error",children:O.cardUrl.message})]})]})};var A=function(e){return Object(p.jsx)("div",{className:"popup galery galery_popup ".concat(e.card?"popup_opened":""),children:Object(p.jsxs)("figure",{className:"galery__popup-image-container",children:[Object(p.jsx)("button",{onClick:e.onClose,type:"button","aria-label":"Close_popup",className:"popup__exit-button galery__popup-exit"}),Object(p.jsx)("img",{src:e.card.link,alt:e.card.name,className:"galery__fulsize-img"}),Object(p.jsx)("figcaption",{className:"galery__popup-text",children:e.card.name})]})})};var w=function(e){var t=e.isOpen,a=e.onClose,n=e.onDeleteCard,r=e.submitButtonName;return Object(p.jsx)(k,{name:"card-delete",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",submitName:r,isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n()}})},T=a(16),P=a(17),D=new(function(){function e(t){Object(T.a)(this,e),this._url=t.url,this._headers=t.headers,this._body=t.body}return Object(P.a)(e,[{key:"_onError",value:function(e,t){return e.ok?e.json():Promise.reject("".concat(t,": ")+e.status)}},{key:"getUserInfo",value:function(){var e=this;return fetch("".concat(this._url,"users/me"),{headers:this._headers}).then((function(t){return e._onError(t,"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0438 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443")}))}},{key:"editUserInfo",value:function(e){var t=this;return fetch("".concat(this._url,"users/me"),{method:"PATCH",headers:{authorization:this._headers.authorization,"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return t._onError(e,"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f")}))}},{key:"getAllCards",value:function(){var e=this;return fetch("".concat(this._url,"cards/"),{headers:this._headers}).then((function(t){return e._onError(t,"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043a\u0430\u0440\u0442\u043e\u0447\u0435\u043a")}))}},{key:"addNewCard",value:function(e){var t=this;return fetch("".concat(this._url,"cards/"),{method:"POST",headers:{authorization:this._headers.authorization,"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return t._onError(e,"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u043d\u043e\u0432\u043e\u0439 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438")}))}},{key:"deleteCard",value:function(e){var t=this;return fetch("".concat(this._url,"cards/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return t._onError(e,"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u043a\u0430\u0440\u0442\u0447\u043e\u043a\u0438")}))}},{key:"handleCardLikeStatus",value:function(e,t){var a=this;console.log("hello from API!");var n=t?"PUT":"DELETE";return fetch("".concat(this._url,"cards/likes/").concat(e),{method:n,headers:this._headers}).then((function(e){return a._onError(e,"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0435 \u043b\u0430\u0439\u043a\u0430")}))}},{key:"changeAvatar",value:function(e){var t=this;return fetch("https://mesto.nomoreparties.co/v1/cohort-20/users/me/avatar",{method:"PATCH",headers:{authorization:this._headers.authorization,"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return t._onError(e,"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440\u043a\u0443")}))}}]),e}())({url:"https://mesto.nomoreparties.co/v1/cohort-20/",headers:{authorization:"036c4f02-47a4-4c62-a975-bbce507f165f"}});var I=function(){return Object(p.jsx)("h2",{className:"error",children:"404 \u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430."})};var U=Object(f.h)((function(e){var t=Object(n.useState)(""),a=Object(l.a)(t,2),r=a[0],s=a[1],c=Object(n.useState)(""),o=Object(l.a)(c,2),i=o[0],u=o[1];return Object(p.jsxs)("section",{className:"sign",children:[Object(p.jsx)("h3",{className:"sign__title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(p.jsxs)("form",{className:"form",onSubmit:function(t){t.preventDefault(),e.onRegister(r,i)},children:[Object(p.jsxs)("label",{className:"form__form-field",children:[Object(p.jsx)("input",{className:" form__input  form__input_type_sign",placeholder:"Email",onChange:function(e){s(e.target.value)}}),Object(p.jsx)("span",{className:"email-name-error form__error"})]}),Object(p.jsxs)("label",{className:"form__form-field",children:[Object(p.jsx)("input",{className:" form__input  form__input_type_sign  form__input_type_password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",type:"password",autoComplete:"none",onChange:function(e){u(e.target.value)}}),Object(p.jsx)("span",{className:"password-name-error form__error"})]}),Object(p.jsx)("button",{className:"form__submit form__submit_type_sign",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]}),Object(p.jsxs)("span",{className:"sign__reg-question",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?\xa0",Object(p.jsx)(b.b,{to:"/signin",className:"sign__link",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})}));var R=Object(f.h)((function(e){var t=Object(n.useState)(""),a=Object(l.a)(t,2),r=a[0],s=a[1],c=Object(n.useState)(""),o=Object(l.a)(c,2),i=o[0],u=o[1];return Object(p.jsxs)("section",{className:"sign",children:[Object(p.jsx)("h3",{className:"sign__title",children:"\u0412\u0445\u043e\u0434"}),Object(p.jsxs)("form",{className:"form",onSubmit:function(t){t.preventDefault(),e.onLogin(r,i)},children:[Object(p.jsxs)("label",{className:"form__form-field",children:[Object(p.jsx)("input",{className:" form__input  form__input_type_sign",placeholder:"Email",onChange:function(e){s(e.target.value)}}),Object(p.jsx)("span",{className:"username-name-error form__error"})]}),Object(p.jsxs)("label",{className:"form__form-field",children:[Object(p.jsx)("input",{className:" form__input  form__input_type_sign  form__input_type_password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",type:"password",autoComplete:"none",onChange:function(e){u(e.target.value)}}),Object(p.jsx)("span",{className:"password-name-error form__error"})]}),Object(p.jsx)("button",{className:"form__submit form__submit_type_sign",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})})),B=a(28);var z=function(e){var t=e.component,a=Object(B.a)(e,["component"]);return Object(p.jsx)(f.b,{children:function(){return a.isLoggedIn?Object(p.jsx)(t,Object(o.a)({},a)):Object(p.jsx)(f.a,{to:"./signin"})}})},M="https://auth.nomoreparties.co";var q=function(e){var t=e.isOpen,a=e.src,n=e.title,r=e.onClose;return Object(p.jsx)("div",{className:"popup ".concat(t?"popup_opened":""),children:Object(p.jsxs)("div",{className:"popup__container popup__container_place_registration",children:[Object(p.jsx)("button",{onClick:r,type:"button","aria-label":"Close_popup",className:"popup__exit-button exit"}),Object(p.jsx)("img",{className:"popup__image",src:a,alt:n}),Object(p.jsx)("h3",{className:"popup__form-title",children:n})]})})};var F=Object(f.h)((function(e){var t=r.a.useState(!1),a=Object(l.a)(t,2),n=a[0],s=a[1],c=r.a.useState(!1),j=Object(l.a)(c,2),b=j[0],_=j[1],h=r.a.useState(!1),x=Object(l.a)(h,2),v=x[0],y=x[1],k=r.a.useState(!1),T=Object(l.a)(k,2),P=T[0],B=T[1],F=r.a.useState(!1),J=Object(l.a)(F,2),H=J[0],G=J[1],V=r.a.useState(!1),W=Object(l.a)(V,2),K=W[0],Q=W[1],X=r.a.useState(!1),Y=Object(l.a)(X,2),Z=Y[0],$=Y[1],ee=r.a.useState([]),te=Object(l.a)(ee,2),ae=te[0],ne=te[1],re=r.a.useState(!0),se=Object(l.a)(re,2),ce=se[0],oe=se[1],ie=r.a.useState(""),le=Object(l.a)(ie,2),ue=le[0],de=le[1],me=r.a.useState({avatar:u,name:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430",about:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430"}),je=Object(l.a)(me,2),be=je[0],pe=je[1],_e=r.a.useState({isOpen:!1,src:"",title:""}),he=Object(l.a)(_e,2),fe=he[0],Oe=he[1],ge=r.a.useState({email:null}),xe=Object(l.a)(ge,2),ve=xe[0],Ne=xe[1];function Ce(e,t,a){Oe({isOpen:e,src:t,title:a})}function ye(){_(!b),console.log("LoginStatus changed: ",b)}function ke(e){de(e)}function Se(){y(!1),B(!1),G(!1),Q(!1),$(!1),Oe({isOpen:!1})}return r.a.useEffect((function(){!function(){if(localStorage.getItem("token")){var t=localStorage.getItem("token");t&&function(e){return fetch("".concat(M,"/users/me"),{method:"GET",headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.ok?e.json():Promise.reject("### ERROR: ".concat(e.statusText))}))}(t).then((function(t){t&&(_(!0),console.log(t.data.email),Ne({email:t.data.email}),e.history.push("/"))})).catch((function(e){return console.log(e)}))}}(),D.getUserInfo().then((function(e){return pe(e)})).catch((function(e){return console.log("#####Error: user data; ",e)}))}),[]),r.a.useEffect((function(){D.getAllCards().then((function(e){ne(e),oe(!1)})).catch((function(e){return console.log("Cards data error: ",e)}))}),[]),Object(p.jsxs)(g.Provider,{value:be,children:[Object(p.jsxs)("div",{className:"page",children:[Object(p.jsx)(O,{isLoggedIn:b,signOut:function(){localStorage.removeItem("token"),ye(),s(!1)},userData:ve,onClose:Se,isMenuOpen:n,handleMenuOpen:function(){console.log("click",n),s(!n)}}),Object(p.jsxs)(f.d,{children:[Object(p.jsx)(z,{exact:!0,path:"/",isLoggedIn:b,cards:ae,loadingSpinner:ce,onEditProfile:function(){ke("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),y(!v)},onAddPlace:function(){ke("\u0421\u043e\u0437\u0434\u0430\u0442\u044c"),B(!P)},onEditAvatar:function(){ke("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),G(!H)},onCardClick:function(e){$(e)},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===be._id}));D.handleCardLikeStatus(e._id,!t).then((function(t){ne((function(a){return a.map((function(a){return a._id===e._id?t:a}))}))})).catch((function(e){return console.log("#### Handle Like Error ####",e)}))},onDeleteCardClick:function(e){ke("\u0423\u0434\u0430\u043b\u0438\u0442\u044c"),Q(e)},setIsDeleteCardPopupOpened:Q,component:N}),Object(p.jsx)(f.b,{path:"/signup",children:Object(p.jsx)(U,{handleTooltip:Ce,infoTolltip:fe,onClose:Se,onRegister:function(t,a){(function(e,t){return fetch("".concat(M,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.ok?e.json():Promise.reject("### ERRROR: ".concat(e.status))}))})(t,a).then((function(t){t?(Ce(!0,m,"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!"),setTimeout((function(){Se(),e.history.push("/signin")}),2e3),console.log("succsess")):console.log("failed!")})).catch((function(e){Ce(!0,d,"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."),console.log(e)}))}})}),Object(p.jsx)(f.b,{path:"/signin",children:b?Object(p.jsx)(f.a,{to:"/"}):Object(p.jsx)(R,{handleLoginStatus:ye,handleTooltip:Ce,handleUserData:Ne,infoTolltip:fe,onClose:Se,onLogin:function(t,a){(function(e,t){return fetch("".concat(M,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.ok?e.json():Promise.reject("#### ERROR: ".concat(e.statusText))}))})(t,a).then((function(e){localStorage.setItem("token",e.token)})).then((function(){ye(),Ne({email:t}),e.history.push("/")})).catch((function(e){Ce(!0,d,"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."),console.log(e)}))}})}),Object(p.jsx)(f.b,{path:"*",children:Object(p.jsx)(I,{})})]}),Object(p.jsx)(C,{})]}),Object(p.jsx)(A,{card:Z,onClose:Se}),Object(p.jsx)(S,{isOpen:v,onClose:Se,onUpdateUser:function(e){ke("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),D.editUserInfo(e).then((function(e){pe(e),Se()})).catch((function(e){return console.log("#### Edit user failed ####",e)}))},submitButtonName:ue}),Object(p.jsx)(E,{isOpen:H,onClose:Se,onUpdateAvatar:function(e){ke("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),D.changeAvatar(e).then((function(e){pe(e),Se()})).catch((function(e){return console.log("#### Avatar update falied ####",e)}))},submitButtonName:ue}),Object(p.jsx)(L,{isOpen:P,onClose:Se,onAddPlace:function(e){ke("\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435..."),D.addNewCard(e).then((function(e){ne([e].concat(Object(i.a)(ae))),Se()})).catch((function(e){return console.log("#### Add card failed ####",e)}))},submitButtonName:ue}),Object(p.jsx)(w,{isOpen:K,onClose:Se,onDeleteCard:function(){var e;e=K,ke("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435..."),D.deleteCard(e._id).then((function(){ne((function(t){return t.filter((function(t){return t._id===e._id?null:t}))})),Se()})).catch((function(e){return console.log("#### Delete card error ####",e)}))},submitButtonName:ue}),Object(p.jsx)(q,Object(o.a)(Object(o.a)({},fe),{},{onClose:Se}))]})})),J=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,41)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,s=t.getLCP,c=t.getTTFB;a(e),n(e),r(e),s(e),c(e)}))};c.a.render(Object(p.jsx)(r.a.StrictMode,{children:Object(p.jsx)(b.a,{children:Object(p.jsx)(F,{})})}),document.querySelector("#root")),J()}},[[40,1,2]]]);
//# sourceMappingURL=main.2adf5202.chunk.js.map